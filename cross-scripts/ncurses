url=$mirror/ncurses.tar.gz

fetch() {
	wget -c $url -O src/ncurses.tar.gz
}

unpack() {
	pushd src
	[ -d ncurses-5.9 ] || tar xzf ncurses.tar.gz
	popd
}

build() {
	pushd src/ncurses-5.9
	cp $top/stuff/ncurses-fallback.c ncurses/fallback.c
	CC="x86_64-linux-musl-gcc -static" ./configure --prefix=$libcroot --without-tests \
		--with-normal --enable-sigwinch --disable-nls --without-dlsym \
		--without-cxx-binding \
		--with-fallbacks="linux vt100 xterm xterm256-color" </dev/ptmx || return 1
	make -j$nprocs || return 1
	popd
}

install() {
	pushd src/ncurses-5.9
	make install || return 1
	popd
}
